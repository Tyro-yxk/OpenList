System.register(["./index-legacy-CEiNF2du.js","./share-legacy-DlmrI4Vd.js","./item_type-legacy-BFH7Oxl9.js","./ResponsiveGrid-legacy-z5Ipjbbr.js","./index-legacy-UY-1t2w8.js"],function(e,r){"use strict";var t,n,a,l,o,u,g,i,d,c,h,s,p,v,m,y,f,b,C,w,$,_,x,S,k,O,T,I,H,P,F,j,z,R,E,M,N,q,B,D,G,Q,J,L,X,A,K,U,V,W,Z,Y,ee,re,te,ne,ae,le,oe,ue,ge,ie,de,ce;return{setters:[e=>{t=e.A,n=e.C,a=e.dG,l=e.am,o=e.bU,u=e.dH,g=e.b8,i=e.z,d=e._,c=e.dI,h=e.B,s=e.ai,p=e.av,v=e.S,m=e.aL,y=e.aD,f=e.dJ,b=e.af,C=e.k,w=e.aa,$=e.Z,_=e.ag,x=e.Q,S=e.y,k=e.bt,O=e.aX,T=e.T,I=e.l,H=e.az,P=e.K,F=e.M,j=e.D,z=e.bu,R=e.E,E=e.F,M=e.H,N=e.J,q=e.bE,B=e.a7,D=e.a8,G=e.I,Q=e.bQ,J=e.bF,L=e.bW,X=e.aQ,A=e.bR,K=e.g,U=e.bq,V=e.bV,W=e.c0,Z=e.a5,Y=e.q,ee=e.an,re=e.bT},e=>{te=e.r,ne=e.g},e=>{ae=e.T},e=>{le=e.R},e=>{oe=e.o,ue=e.E,ge=e.G,ie=e.H,de=e.I,ce=e.n}],execute:function(){const r=a(),he=e=>{const[a,o]=t("/");return e.handle?.({setPath:o}),n(l,{class:"folder-tree-box",w:"$full",overflowX:"auto",get children(){return n(r.Provider,{get value(){return{value:a,onChange:r=>{o(r),e.onChange(r)},autoOpen:e.autoOpen??!1,forceRoot:e.forceRoot??!1,showEmptyIcon:e.showEmptyIcon??!1,showHiddenFolder:e.showHiddenFolder??!0}},get children(){return n(se,{path:"/"})}})}})},se=e=>{const{isHidePath:a}=o(),[O,T]=t(),{value:I,onChange:H,forceRoot:P,autoOpen:F,showEmptyIcon:j,showHiddenFolder:z}=u(r),[R,E]=g(()=>i(e.path,d(),1,0,!1));let M=!1;const N=async()=>{if(O()?.length)return;const e=await E();k(e,e=>{M=!0,T(e.content||[])},()=>{q()&&B()})},{isOpen:q,onToggle:B}=function(){const[e,r]=t(!1);return{isOpen:e,onToggle:()=>r(!e()),onOpen:()=>r(!0),onClose:()=>r(!1)}}(),D=()=>I()===e.path,G=c(e.path);return h(s(I,async e=>{F&&G(e)&&(q()||B(),M||N())})),n(v,{get when(){return z||!(a(e.path)&&!G(I()))},get children(){return n(l,{get children(){return[n(p,{spacing:"$2",get children(){return[n(v,{get when(){return!R()},get fallback(){return n(f,{size:"sm",get color(){return y()}})},get children(){return n(v,{get when(){return!Boolean(j&&void 0!==O()&&!O()?.length)},get fallback(){return n(m,{get color(){return y()},as:ue})},get children(){return n(m,{get color(){return y()},as:oe,get transform(){return q()?"rotate(90deg)":"none"},transition:"transform 0.2s",cursor:"pointer",onClick:()=>{B(),q()&&N()}})}})}}),n(m,{get color(){return y()},as:ge,cursor:"pointer"}),n(b,{css:{whiteSpace:"nowrap"},fontSize:"$md",cursor:"pointer",px:"$1",rounded:"$md",get bgColor(){return D()?"$info8":"transparent"},get _hover(){return{bgColor:D()?"$info8":$()}},onClick:()=>{H(e.path)},get children(){return w(()=>"/"===e.path)()?"root":C(e.path)}})]}}),n(v,{get when(){return q()},get children(){return n(_,{mt:"$1",pl:"$4",alignItems:"start",spacing:"$1",get children(){return[n(x,{get each(){return O()?.filter(e=>e.is_dir)||[]},children:r=>n(se,{get path(){return S(e.path,r.name)}})}),n(x,{get each(){return O()?.filter(e=>!e.is_dir)||[]},children:r=>n(p,{spacing:"$2",w:"$full",get children(){return[n(l,{w:"16px"}),n(m,{get color(){return y()},as:ie,cursor:"pointer"}),n(b,{css:{whiteSpace:"nowrap"},fontSize:"$md",cursor:"pointer",px:"$1",rounded:"$md",get bgColor(){return I()===S(e.path,r.name)?"$info8":"transparent"},get _hover(){return{bgColor:I()===S(e.path,r.name)?"$info8":$()}},onClick:()=>{H(S(e.path,r.name))},get children(){return r.name}})]}})})]}})}})]}})}})},pe=e=>{const r=I(),{isOpen:a,onOpen:l,onClose:o}=O(),[u,g]=t("/"),i=()=>{const r=e.value?e.value.split("\n"):[];let t=u();e.basePath&&(t=S(e.basePath,t));const n=[...r,t].filter(Boolean),a=[...new Set(n)];e.onChange(a.join("\n")),o()};return n(_,{w:"$full",spacing:"$2",alignItems:"stretch",get children(){return[n(p,{w:"$full",spacing:"$2",get children(){return[n(T,{get id(){return e.id},flex:"1",get value(){return e.value},get invalid(){return!e.valid},get readOnly(){return e.readOnly},get placeholder(){return e.placeholder||r("shares.files_placeholder")},onInput:r=>e.onChange(r.currentTarget.value)}),n(H,{colorScheme:"accent",get"aria-label"(){return r("global.choose_or_input_path")},get icon(){return n(ge,{})},onClick:l,size:"lg",get disabled(){return e.readOnly}})]}}),n(P,{size:"xl",get opened(){return a()},onClose:o,get children(){return[n(F,{}),n(j,{get children(){return[n(z,{}),n(R,{get children(){return r("global.choose_or_input_path")}}),n(E,{get children(){return n(he,{forceRoot:!0,onChange:g,showHiddenFolder:!0})}}),n(M,{display:"flex",gap:"$2",get children(){return[n(N,{onClick:o,colorScheme:"neutral",get children(){return r("global.cancel")}}),n(N,{onClick:i,colorScheme:"primary",get leftIcon(){return n(de,{})},get children(){return r("shares.add_path")}})]}})]}})]}})]}})},ve=e=>{const r=I();return n(A,{w:"$full",display:"flex",flexDirection:"column",get required(){return e.required},get children(){return[n(q,{get for(){return e.name},display:"flex",alignItems:"center",get children(){return r(e.full_name_path??`shares.${e.name}`)}}),n(B,{get fallback(){return n(X,{get children(){return r("settings.unknown_type")}})},get children(){return[n(D,{get when(){return e.type===ae.String},get children(){return n(p,{w:"$full",spacing:"$2",get children(){return[n(G,{get id(){return e.name},type:"text",get readOnly(){return e.readonly},get value(){return e.value},get invalid(){return!e.valid},get placeholder(){return e.placeholder},get onChange(){return e.type===ae.String?r=>e.onChange?.(r.currentTarget.value):void 0}}),n(v,{get when(){return w(()=>e.type===ae.String)()&&e.random},get children(){return n(H,{colorScheme:"neutral","aria-label":"random",get icon(){return n(ce,{})},get onClick(){return e.type===ae.String?()=>e.onChange?.(e.random()):void 0}})}})]}})}}),n(D,{get when(){return e.type===ae.Number},get children(){return n(G,{type:"number",get id(){return e.name},get readOnly(){return e.readonly},get value(){return e.value},get invalid(){return!e.valid},get placeholder(){return e.placeholder},get onInput(){return e.type===ae.Number?r=>e.onChange?.(parseInt(r.currentTarget.value)):void 0}})}}),n(D,{get when(){return e.type===ae.Float},get children(){return n(G,{type:"number",get id(){return e.name},get readOnly(){return e.readonly},get value(){return e.value},get invalid(){return!e.valid},get placeholder(){return e.placeholder},get onInput(){return e.type===ae.Float?r=>e.onChange?.(parseFloat(r.currentTarget.value)):void 0}})}}),n(D,{get when(){return e.type===ae.Bool},get children(){return n(Q,{get id(){return e.name},get readOnly(){return e.readonly},get defaultChecked(){return e.value},get invalid(){return!e.valid},get onChange(){return e.type===ae.Bool?r=>e.onChange?.(r.currentTarget.checked):void 0}})}}),n(D,{get when(){return e.type===ae.Text},get children(){return n(T,{get id(){return e.name},get readOnly(){return e.readonly},get value(){return e.value},get invalid(){return!e.valid},get placeholder(){return e.placeholder},get onChange(){return e.type===ae.Text?r=>e.onChange?.(r.currentTarget.value):void 0}})}}),n(D,{get when(){return e.type===ae.MultiPath},get children(){return n(pe,{get id(){return e.name},get value(){return e.value},get valid(){return e.valid},get readOnly(){return e.readonly},get basePath(){return e.basePath},onChange:r=>{e.type===ae.MultiPath&&e.onChange?.(r)}})}}),n(D,{get when(){return e.type===ae.Select},get children(){return n(J,{get id(){return e.name},get readOnly(){return e.readonly},get value(){return e.value},get invalid(){return!e.valid},get onChange(){return e.type===ae.Select?r=>e.onChange?.(r):void 0},get children(){return n(L,{get readonly(){return e.readonly},get searchable(){return w(()=>e.type===ae.Select)()&&e.searchable},get options(){return e.options.split(",").map(t=>({key:t,label:r((e.options_prefix??`shares.${e.name}s`)+`.${t}`)}))}})}})}})]}})]}})};e("default",()=>{const e=I(),{params:r,back:a,to:l}=K(),{id:o}=r,[u,i]=g(()=>U.get(`/share/get?id=${o}`),!0),[d,c]=V({}),[h,s]=t(""),[p,m]=t(!1),[y,f]=t(""),[b,C]=t(!0);o&&(async()=>{const e=await i();k(e,e=>{re(()=>{c(e),s(e.files.join("\n")),e.expires&&f(new Date(e.expires).toLocaleString()),m(!0)})})})();const[w,$]=g(()=>U.post("/share/"+(o?"update":"create"),d));return n(ee,{get loading(){return!!o&&u()},get children(){return[n(W,{mb:"$2",get children(){return e("global."+(o?"edit":"add"))}}),n(le,{get children(){return[n(v,{when:o,get children(){return n(ve,{name:"id",get type(){return ae.String},value:o,valid:!0,readonly:!0})}}),n(ve,{name:"files",get type(){return ae.MultiPath},get value(){return h()},get valid(){return p()},get basePath(){return Z().base_path},required:!0,onChange:e=>{s(e),m(e.length>0),c("files",e.split("\n"))}}),n(ve,{name:"remark",get type(){return ae.Text},get value(){return d.remark},valid:!0,onChange:e=>{c("remark",e)}}),n(ve,{name:"extract_folder",get type(){return ae.Select},get value(){return d.extract_folder},valid:!0,options:"front,back",onChange:e=>{c("extract_folder",e)}}),n(ve,{name:"order_by",get type(){return ae.Select},get value(){return d.order_by},valid:!0,options:"name,size,modified",onChange:e=>{c("order_by",e)}}),n(ve,{name:"order_direction",get type(){return ae.Select},get value(){return d.order_direction},valid:!0,options:"asc,desc",onChange:e=>{c("order_direction",e)}}),n(ve,{name:"pwd",get type(){return ae.String},get value(){return d.pwd},valid:!0,onChange:e=>{c("pwd",e)},random:te}),n(ve,{name:"max_accessed",get type(){return ae.Number},get value(){return d.max_accessed},valid:!0,onChange:e=>{c("max_accessed",e)}}),n(v,{when:o,get children(){return n(ve,{name:"accessed",get type(){return ae.Number},get value(){return d.accessed},valid:!0,onChange:e=>{c({...d,accessed:e})}})}}),n(ve,{name:"expires",get type(){return ae.String},get value(){return y()},get valid(){return b()},placeholder:"yyyy-MM-dd HH:mm:ss or +1w1d1H1m1s1ms",onChange:e=>{if(f(e),""===e)return C(!0),void c("expires",null);const r=ne(e);isNaN(r.getTime())?C(!1):(C(!0),c("expires",r.toISOString()))}}),n(ve,{name:"readme",get type(){return ae.Text},get value(){return d.readme},valid:!0,onChange:e=>{c("readme",e)}}),n(ve,{name:"header",get type(){return ae.Text},get value(){return d.header},valid:!0,onChange:e=>{c("header",e)}})]}}),n(N,{mt:"$2",get disabled(){return!b()||!p()},get loading(){return w()},onClick:async()=>{const r=await $();k(r,()=>{Y.success(e("global.save_success")),a()},(e,t)=>{r.data.id&&l(`/@manage/shares/edit/${r.data.id}`)})},get children(){return e("global."+(o?"save":"add"))}})]}})})}}});
